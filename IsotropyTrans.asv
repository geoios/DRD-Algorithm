function Ps = IsotropyTrans(Zs,As,Ps)
n = length(Zs);
if nargin == 2
   for i=1:n
       Zsi = Zs{i};
       for j=1:length(Zsi)
           Ps{i}(j) = Zs{i}(j)^2;
           As{j}(j)
       end
   end
else
   for i=1:n
       Zsi = Zs{i};
       for j=1:length(Zsi)
           Ps{i}(j) = Zs{i}(j)^2 * Ps{i}(j);
       end
   end
end

end